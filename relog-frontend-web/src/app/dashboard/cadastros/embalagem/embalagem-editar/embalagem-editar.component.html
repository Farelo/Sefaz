<div class="">
  <h2>Editar Embalagem</h2>
  <hr>

  <form novalidate (ngSubmit)="onSubmit(mRack)" [formGroup]="mRack" #formDir="ngForm">

    <!-- Linha 1 TAG -->
    <div class="row">

      <!-- Codigo -->
      <div class="col-sm-12 col-md-3 campo" formGroupName="tag" style="padding-right: 0px;">
        <p class="descricao">TAG</p>
        <p class="explicacao">Ex. "994475545"</p>
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Código da tag" aria-describedby="basic-addon2"
            formControlName="code" maxlength="25" (focusout)="validateTag($event)" [ngClass]="{'required': (mRack.get('tag.code').hasError('required') && mRack.get('tag.code').touched)
              || (mRack.get('tag.code').hasError('required') && formDir.submitted)
              || (mRack.get('tag.code').hasError('pattern'))
              || (mRack.get('tag.code').hasError('pattern') && formDir.submitted)
              || (mRack.get('tag.code').hasError('minlength'))
              || (mRack.get('tag.code').hasError('minlength') && formDir.submitted)
              || (mRack.get('tag.code').hasError('uniqueValidation'))
              || (mRack.get('tag.code').hasError('uniqueValidation') && formDir.submitted) }">
        </div>

        <p class="requiredText" *ngIf="(mRack.get('tag.code').hasError('required') && mRack.get('tag.code').touched)
            || (mRack.get('tag.code').hasError('required') && formDir.submitted)">
          Campo Obrigatório</p>

        <p class="requiredText" *ngIf="(mRack.get('tag.code').hasError('uniqueValidation')) 
            || (mRack.get('tag.code').hasError('uniqueValidation') && formDir.submitted)">
          Esta Embalagem já existe. O código deve ser único.</p>

        <p class="requiredText" *ngIf="(mRack.get('tag.code').hasError('minlength')) 
            || (mRack.get('tag.code').hasError('minlength') && formDir.submitted)">
          Mínimo de 4 caracteres</p>

        <p class="explicacao" *ngIf="validateNotTakenLoading">
          Verificando disponibilidade ...</p>

        <p class="requiredText" *ngIf="(mRack.get('tag.code').hasError('pattern')) 
                        || (mRack.get('tag.code').hasError('pattern') && formDir.submitted)">
          Excesso de espaços em branco</p>
      </div>


      <!-- Version -->
      <div class="col-sm-12 col-md-3" formGroupName="tag">
        <p class="descricao">VERSÃO</p>
        <p class="explicacao">Ex. "v1"</p>
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Versão" aria-describedby="basic-addon2" formControlName="version"
            maxlength="100" [ngClass]="{'required': (mRack.get('tag.version').hasError('required') && mRack.get('tag.version').touched)
              || (mRack.get('tag.version').hasError('required') && formDir.submitted)
              || (mRack.get('tag.version').hasError('pattern'))
              || (mRack.get('tag.version').hasError('pattern') && formDir.submitted) }">
        </div>

        <p class="requiredText" *ngIf="(mRack.get('tag.version').hasError('required') && mRack.get('tag.version').touched)
                      || (mRack.get('tag.version').hasError('required') && formDir.submitted)">
          Campo Obrigatório</p>

        <p class="requiredText" *ngIf="(mRack.get('tag.version').hasError('pattern')) 
          || (mRack.get('tag.version').hasError('pattern') && formDir.submitted)">
          Excesso de espaços em branco</p>
      </div>


      <!-- Projeto -->
      <div class="col-sm-12 col-md-3" style="padding-right: 0px;">
        <p class="descricao">PROJETO</p>
        <p class="explicacao">Projeto da Embalagem</p>
        <ng-select bindLabel="name" placeholder="Associe um projeto" [items]="listOfProjects" formControlName="project">

          <ng-template ng-option-tmp let-item="item">
            <div> {{item.name}} </div>
          </ng-template>
        </ng-select>
        <p class="requiredText" *ngIf="(mRack.get('project').hasError('required') && mRack.get('project').touched)
                              || (mRack.get('project').hasError('required') && formDir.submitted)">
          Campo Obrigatório</p>
      </div>

      <!-- Modelo -->
      <div class="col-sm-12 col-md-3" formGroupName="tag">
        <p class="descricao">MODELO</p>
        <p class="explicacao">Modelo do dispositivo</p>
        <ng-select bindLabel="label" bindValue="name" placeholder="Associe um modelo" [items]="deviceModel" formControlName="deviceModel">

          <ng-template ng-option-tmp let-item="item">
            <div> {{item.label}} </div>
          </ng-template>
        </ng-select>
        <p class="requiredText" *ngIf="(mRack.get('tag.deviceModel').hasError('required') && mRack.get('tag.deviceModel').touched)
                              || (mRack.get('tag.deviceModel').hasError('required') && formDir.submitted)">
          Campo Obrigatório</p>  
      </div>

    </div>


    <!-- Linha 2 Embalagem -->
    <div class="row">

      <!-- Coluna 1 -->
      <div class="col-md-6">
        <div class="row">
          <!-- Família -->
          <div class="col-sm-12 campo">
            <p class="descricao">FAMÍLIA</p>
            <p class="explicacao">Ex. "AAB-01"</p>
            <ng-select bindLabel="code" placeholder="Associe uma família" [items]="listOfFamilies" formControlName="family">

              <ng-template ng-option-tmp let-item="item">
                <div> {{item.code}} </div>
              </ng-template>
            </ng-select>
            <p class="requiredText" *ngIf="(mRack.get('family').hasError('required') && mRack.get('family').touched)
                || (mRack.get('family').hasError('required') && formDir.submitted)">
              Campo Obrigatório</p>
          </div>

          <!-- Serial -->
          <div class="col-sm-12 campo">
            <p class="descricao">SERIAL</p>
            <p class="explicacao">Ex. "001"</p>
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Serial" aria-describedby="basic-addon2"
                formControlName="serial" maxlength="30" [ngClass]="{'required': (mRack.get('serial').hasError('required') && mRack.get('serial').touched)
                || (mRack.get('serial').hasError('required') && formDir.submitted)
                || (mRack.get('tag.version').hasError('minlength'))
                || (mRack.get('tag.version').hasError('minlength') && formDir.submitted)
                || (mRack.get('serial').hasError('pattern'))
                || (mRack.get('serial').hasError('pattern') && formDir.submitted) }">
            </div>

            <p class="requiredText" *ngIf="(mRack.get('serial').hasError('required') && mRack.get('serial').touched)
              || (mRack.get('serial').hasError('required') && formDir.submitted)">
              Campo Obrigatório</p>

            <p class="requiredText" *ngIf="(mRack.get('serial').hasError('minlength')) 
                    || (mRack.get('serial').hasError('minlength') && formDir.submitted)">
              Mínimo de 2 caracteres</p>

            <p class="requiredText" *ngIf="(mRack.get('serial').hasError('pattern')) 
              || (mRack.get('serial').hasError('pattern') && formDir.submitted)">
              Excesso de espaços em branco</p>
          </div>

          <!-- Fabricante -->
          <div class="col-sm-12 campo" formGroupName="tag">
            <p class="descricao">FABRICANTE DA EMBALAGEM</p>
            <p class="explicacao">Ex. "Acme Racks"</p>
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Nome do Fabricante" aria-describedby="basic-addon2"
                formControlName="manufactorer" maxlength="100" [ngClass]="{'required': (mRack.get('tag.manufactorer').hasError('required') && mRack.get('tag.manufactorer').touched)
                  || (mRack.get('tag.manufactorer').hasError('required') && formDir.submitted)
                  || (mRack.get('tag.manufactorer').hasError('minlength'))
                  || (mRack.get('tag.manufactorer').hasError('minlength') && formDir.submitted)
                  || (mRack.get('tag.manufactorer').hasError('pattern'))
                  || (mRack.get('tag.manufactorer').hasError('pattern') && formDir.submitted) }">
            </div>
            <p class="requiredText" *ngIf="(mRack.get('tag.manufactorer').hasError('required') && mRack.get('tag.manufactorer').touched)
                || (mRack.get('tag.manufactorer').hasError('required') && formDir.submitted)">
              Campo Obrigatório</p>

            <p class="requiredText" *ngIf="(mRack.get('tag.manufactorer').hasError('minlength'))
                || (mRack.get('tag.manufactorer').hasError('minlength') && formDir.submitted)">
              Mínimo de 2 caracteres</p>

            <p class="requiredText" *ngIf="(mRack.get('tag.manufactorer').hasError('pattern')) 
                || (mRack.get('tag.manufactorer').hasError('pattern') && formDir.submitted)">
              Excesso de espaços em branco</p>
          </div>


          <!-- Tipo da embalagem -->
          <div class="col-sm-12 campo">
            <p class="descricao">TIPO DA EMBALAGEM</p>
            <p class="explicacao">Ex. "Rack Metálico"</p>
            <input type="text" class="form-control" placeholder="Digite o tipo de embalagem" aria-describedby="basic-addon2"
              formControlName="type" maxlength="100" [ngClass]="{'required': (mRack.get('type').hasError('required') && mRack.get('type').touched)
                || (mRack.get('type').hasError('required') && formDir.submitted)
                || (mRack.get('type').hasError('pattern'))
                || (mRack.get('type').hasError('pattern') && formDir.submitted) }">

            <p class="requiredText" *ngIf="(mRack.get('type').hasError('required') && mRack.get('type').touched)
              || (mRack.get('type').hasError('required') && formDir.submitted)">
              Campo Obrigatório</p>

            <p class="requiredText" *ngIf="(mRack.get('type').hasError('pattern')) 
                            || (mRack.get('type').hasError('pattern') && formDir.submitted)">
              Excesso de espaços em branco</p>
          </div>


          <!-- Capacidade da embalagem -->
          <div class="col-sm-12 campo">
            <p class="descricao">CAPACIDADE DA EMBALAGEM</p>
            <p class="explicacao">Ex. "57 PEÇAS"</p>
            <div class="placeholder" data-placeholder="PEÇAS">
              <input type="number" min="0" class="form-control form-control-sm scroll-number" value="0" formControlName="capacity"
                [ngClass]="{'required': (mRack.get('capacity').hasError('required') && mRack.get('capacity').touched)
                  || (mRack.get('capacity').hasError('required') && formDir.submitted)}" />
            </div>
            <p class="requiredText" *ngIf="(mRack.get('capacity').hasError('required') && mRack.get('capacity').touched)
              || (mRack.get('capacity').hasError('required') && formDir.submitted)">
              Campo Obrigatório</p>
            <p class="requiredText" *ngIf="(mRack.get('capacity').hasError('pattern'))
                          || (mRack.get('capacity').hasError('pattern') && formDir.submitted)">
              Valor inválido</p>
          </div>


          <div class="col-sm-12 campo">
            <div class="checkbox">
              <label>
                <input type="checkbox" value="active" formControlName="active">
                <span class="cr"> <i class="cr-icon fa fa-check"> </i> </span>
                Embalagem ativa
              </label>
            </div>
          </div>


        </div>
      </div>


      <!-- Coluna 2 -->
      <div class="col-md-6">

        <div class="campo">
          <p class="descricao">TARA (KG)</p>
          <p class="explicacao">Ex. "86,7 kg"</p>
          <div class="placeholder" data-placeholder="KG">
            <input type="number" min="0" class="form-control form-control-sm scroll-number" value="0" step="0.2"
              formControlName="weigth" [ngClass]="{'required': (mRack.get('weigth').hasError('required') && mRack.get('weigth').touched)
              || (mRack.get('weigth').hasError('required') && formDir.submitted)}" />
          </div>
          <p class="requiredText" *ngIf="(mRack.get('weigth').hasError('required') && mRack.get('weigth').touched)
            || (mRack.get('weigth').hasError('required') && formDir.submitted)">
            Campo Obrigatório</p>
          <p class="requiredText" *ngIf="(mRack.get('weigth').hasError('pattern'))
            || (mRack.get('weigth').hasError('pattern') && formDir.submitted)">
            Valor inválido</p>
        </div>

        <div class="campo">
          <p class="descricao">COMPRIMENTO (M)</p>
          <p class="explicacao">Ex. "7,1 m"</p>
          <div class="placeholder" data-placeholder="METROS">
            <input type="number" min="0" class="form-control form-control-sm scroll-number" value="0" step="0.2"
              formControlName="length" [ngClass]="{'required': (mRack.get('length').hasError('required') && mRack.get('length').touched)
                || (mRack.get('length').hasError('required') && formDir.submitted)}" />
          </div>
          <p class="requiredText" *ngIf="(mRack.get('length').hasError('required') && mRack.get('length').touched)
            || (mRack.get('length').hasError('required') && formDir.submitted)">
            Campo Obrigatório</p>
          <p class="requiredText" *ngIf="mRack.get('length').hasError('pattern')
            || (mRack.get('length').hasError('pattern') && formDir.submitted)">
            Valor inválido</p>
        </div>

        <div class="campo">
          <p class="descricao">LARGURA (M)</p>
          <p class="explicacao">Ex. "9,5 m"</p>
          <div class="placeholder" data-placeholder="METROS">
            <input type="number" min="0" class="form-control form-control-sm scroll-number" value="0" step="0.2"
              formControlName="width" [ngClass]="{'required': (mRack.get('width').hasError('required') && mRack.get('width').touched)
                || (mRack.get('width').hasError('required') && formDir.submitted)}" />
          </div>
          <p class="requiredText" *ngIf="(mRack.get('width').hasError('required') && mRack.get('width').touched)
              || (mRack.get('width').hasError('required') && formDir.submitted)">
            Campo Obrigatório</p>
          <p class="requiredText" *ngIf="(mRack.get('width').hasError('pattern'))
            || (mRack.get('width').hasError('pattern') && formDir.submitted)">
            Valor inválido</p>
        </div>

        <div class="campo">
          <p class="descricao">ALTURA (M)</p>
          <p class="explicacao">Ex. "57,2 m"</p>
          <div class="placeholder" min="0" data-placeholder="METROS">
            <input type="number" min="0" class="form-control form-control-sm scroll-number" value="0" step="0.2"
              formControlName="heigth" [ngClass]="{'required': (mRack.get('heigth').hasError('required') && mRack.get('heigth').touched)
              || (mRack.get('heigth').hasError('required') && formDir.submitted)}" />
          </div>
          <p class="requiredText" *ngIf="(mRack.get('heigth').hasError('required') && mRack.get('heigth').touched)
              || (mRack.get('heigth').hasError('required') && formDir.submitted)">
            Campo Obrigatório</p>
          <p class="requiredText" *ngIf="(mRack.get('heigth').hasError('pattern') )
            || (mRack.get('heigth').hasError('pattern') && formDir.submitted)">
            Valor inválido</p>
        </div>

        <div class="campo">
          <div class="campo">
            <p class="descricao">OBSERVAÇÕES</p>
            <p class="explicacao">Ex. "Embalagem nova"</p>
            <textarea class="form-control" id="exampleFormControlTextarea1" rows="3" maxlength="140" formControlName="observations">
                  </textarea>
            <p class="explicacao"> {{ mRack.get('observations').value.length }}/140 </p>
          </div>
        </div>

      </div>
    </div>

    <br />

    <div class="botoes">
      <button routerLink="/rc/cadastros/embalagem" class="redButton">VOLTAR</button>
      <button type="submit" class="blueButton">ATUALIZAR</button>
    </div>

    <br />

  </form>
</div>