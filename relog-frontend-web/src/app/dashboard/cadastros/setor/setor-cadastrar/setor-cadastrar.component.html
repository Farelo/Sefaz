<div class="">
  <h2 translate="REGISTER.DEPARTMENT.REGISTER_TITLE"></h2>
  <hr>

  <form novalidate (ngSubmit)="onSubmit(mDepartment)" [formGroup]="mDepartment" #formDir="ngForm">
    
    <div class="row">
      <div class="col-sm-12">
        <div class="campo">
          <p translate="REGISTER.DEPARTMENT.NAME" class="descricao"></p>
          <p translate="REGISTER.DEPARTMENT.NAME_DESC" class="explicacao"></p>
          <div class="input-group">
            <input type="text"
              class="form-control"
              maxlength="50"
              placeholder="{{ 'REGISTER.DEPARTMENT.NAME_PLACEHOLDER' | translate }}"
              aria-describedby="basic-addon2"
              [(ngModel)]="name" formControlName="name"
              [ngClass]="{'required': (mDepartment.get('name').hasError('required') && mDepartment.get('name').touched)
                || (mDepartment.get('name').hasError('required') && formDir.submitted)
                || (mDepartment.get('name').hasError('minlength'))
                || (mDepartment.get('name').hasError('minlength') && formDir.submitted)
                || (mDepartment.get('name').hasError('pattern'))
                || (mDepartment.get('name').hasError('pattern') && formDir.submitted)}">
          </div>
      
          <p translate="REGISTER.ERRORS.REQUIRED" class="requiredText" 
            *ngIf="(mDepartment.get('name').hasError('required') && mDepartment.get('name').touched)
              || (mDepartment.get('name').hasError('required') && formDir.submitted)"> </p>

          <p translate="REGISTER.ERRORS.MIN_5" class="requiredText" *ngIf="(mDepartment.get('name').hasError('minlength'))
            || (mDepartment.get('name').hasError('minlength') && formDir.submitted)"> </p>
          
          <p translate="REGISTER.ERRORS.WHITE_SPACE" class="requiredText" *ngIf="(mDepartment.get('name').hasError('pattern'))
            || (mDepartment.get('name').hasError('pattern') && formDir.submitted)"> </p>
        </div>
      </div>

      <div class="col-sm-12">
        <div class="campo">
          <p translate="REGISTER.DEPARTMENT.LINK" class="descricao"></p>
          <p translate="REGISTER.DEPARTMENT.LINK_DESC" class="explicacao"></p>
      
          <ng-select 
            (change)="onChange($event)"
            [items]="allControlPoints" 
            bindLabel="name" 
            placeholder="{{ 'REGISTER.DEPARTMENT.LINK_PLACEHOLDER' | translate }}"
            formControlName="control_point" 
            [ngClass]="{'required': 
              (mDepartment.get('control_point').hasError('required') && mDepartment.get('control_point').touched) 
              || (mDepartment.get('control_point').hasError('required') && formDir.submitted)}">

            <ng-template ng-label-tmp let-item="item">
              {{item.name}}
            </ng-template>

            <ng-template ng-option-tmp let-item="item">
              {{ item.name }}
            </ng-template>
          </ng-select>
      
          <p translate="REGISTER.ERRORS.REQUIRED" class="requiredText" *ngIf="(mDepartment.get('control_point').hasError('required') && mDepartment.get('control_point').touched)
            || (mDepartment.get('control_point').hasError('required') && formDir.submitted)"> </p>
        </div>
      </div>

      <div class="col-md-12">
        <div class="campo">
          <p translate="REGISTER.DEPARTMENT.SITE" class="descricao"></p>
          <p>
            <ngui-map 
              [zoom]="zoom" 
              [center]="center" 
              (mapReady$)="onMapReady($event)" 
              (click)="onClick($event)">
              <marker [position]="pos"></marker>
            </ngui-map>
          </p>
        </div>
      </div>

      <div class="col-md-12 informacoes">
        <div class="bigger2">
          <div class="fromSun"></div>
        </div>
        <span class="forn">{{mDepartment.value?.control_point?.full_address || 'Nenhuma informação sobre a localidade'}}</span>
      </div>

      <div class="col-md-6 campo">
        <p translate="REGISTER.DEPARTMENT.LAT" class="descricao"></p>
        <div class="input-group">
          <input type="text" class="form-control" readonly placeholder="{{ 'REGISTER.DEPARTMENT.LAT' | translate }}" aria-describedby="basic-addon2"
            [(ngModel)]="lat" formControlName="lat" [ngClass]="{'required': (mDepartment.get('lat').hasError('required') && mDepartment.get('lat').touched)
          || (mDepartment.get('lat').hasError('required') && formDir.submitted)}">
        </div>

        <p translate="REGISTER.ERRORS.REQUIRED" class="requiredText" *ngIf="(mDepartment.get('lat').hasError('required') && mDepartment.get('lat').touched)
        || (mDepartment.get('lat').hasError('required') && formDir.submitted)"> </p>
      </div>

      <div class="col-md-6 campo">
        <p translate="REGISTER.DEPARTMENT.LNG" class="descricao"></p>
        <div class="input-group">
          <input type="text" class="form-control" readonly placeholder="{{ 'REGISTER.DEPARTMENT.LNG' | translate }}" aria-describedby="basic-addon2"
            [(ngModel)]="lng" formControlName="lng" [ngClass]="{'required': (mDepartment.get('lng').hasError('required') && mDepartment.get('lng').touched)
          || (mDepartment.get('lng').hasError('required') && formDir.submitted)}">
        </div>

        <p translate="REGISTER.ERRORS.REQUIRED" class="requiredText" *ngIf="(mDepartment.get('lng').hasError('required') && mDepartment.get('lng').touched)
        || (mDepartment.get('lng').hasError('required') && formDir.submitted)"> </p>
      </div>
      <br />
    </div>

    <br />

    <div class="botoes">
      <button translate="REGISTER.BACK_BUTTON" routerLink="/rc/cadastros/setor" class="botaoVoltar"></button>
      <button translate="REGISTER.REGISTER_BUTTON" type="submit" class="botaoRegistrar"></button>
    </div>
    <br />
  </form>
</div>