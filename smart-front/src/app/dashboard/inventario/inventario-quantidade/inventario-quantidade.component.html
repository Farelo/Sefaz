<div class="base-bg">
  <h2> QUANTIDADE</h2>

  <!-- Linha divisória -->
  <hr style="margin-top: 10px;">
  
  <div class="row">

    <div class="col-sm-4">
      <p>EQUIPAMENTO</p>
      <ng-select [(ngModel)]="quantitySearch" (change)="quantityInventory()" bindValue="packing" [items]="packings" bindLabel="packing"
        placeholder="Selecione um Equipamento">
        <ng-template ng-label-tmp let-item="item">
          {{item.packing}}
        </ng-template>
        <ng-template ng-option-tmp let-item="item">
          <div>
            <b>Embalagem:</b> {{item.packing}}
          </div>
          
          <div>
            <small> <b>Fornecedor:</b> {{item.supplier.name}} </small>
          </div>

          <div>
            <small> <b> Projeto:</b> {{item.project.name}} </small>
          </div>
        </ng-template>
      </ng-select>
    </div>

  </div>

  <br>

  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr class="cabecalho">
          <th>DUNS</th>
          <th>Projeto</th>
          <th>Fornecedor</th>
          <th>Planta</th>
          <th>Local</th>
          <th>Quantidade</th>
          <th>Min</th>
          <th>Max</th>
          <th>Diferença</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let packing of quantity.data | paginate: {
                                                        id:'quantity',
                                                        itemsPerPage: 10,
                                                        currentPage: quantity.meta.page,
                                                        totalItems: quantity.meta.total_docs}">

          <td>{{packing.supplier?.duns || '-'}}</td>
          <td>{{packing.project?.name || '-'}}</td>
          <td>{{packing.supplier?.name || '-'}}</td>
          <td>{{packing.actual_plant?.plant ? packing.actual_plant?.plant?.plant_name : (packing.missing ? "Embalagem Ausente"
            : "Embalagem em Viagem")}}</td>
          <td>{{packing.actual_plant?.local === 'Factory' ? 'Fábrica' : (packing.actual_plant?.local === 'Supplier' ? 'Fornecedor':
            (packing.actual_plant?.local === 'Logistic' ? 'Op. Logístico': 'Sem Registro'))}}</td>
          <td>{{packing.quantity || '-'}}</td>
          <td>{{packing.actual_gc16 ? (packing.actual_gc16.min == 0 ? 0 : packing.actual_gc16.min) : '-'}}</td>
          <td>{{packing.actual_gc16 ? (packing.actual_gc16.max == 0 ? 0 : packing.actual_gc16.max) : '-'}}</td>
          <td>{{packing.actual_gc16 ? (packing.actual_gc16?.min > packing.quantity ? (packing.quantity-packing.actual_gc16?.min)
            : (packing.actual_gc16?.max
            < packing.quantity ? packing.quantity-packing.actual_gc16?.max : 'NP')) : '-' }}</td>
              <td>{{packing.missing ? 'Ausente': (packing.problem ? 'Local Errado' : (packing.traveling ? 'Viajando' : 'Sem Anormalidade'))
                }}</td>
        </tr>
      </tbody>
    </table>

    <div class="classVazio" *ngIf="quantity.data?.length < 1">
      Selecione um equipamento
    </div>

  </div>
  
  <br>

  <div class="resumo">
    <h3 class="definicao">TOTAL: </h3>
    <h3 class="numero">{{quantity.meta?.total_packings || 0}}</h3>
  </div>
  
  <div class="resumo">
    <h3 class="definicao">DIFERENÇA: </h3>
    <h3 class="numero">{{quantity.meta?.missing || 0}}</h3>
  </div>

  <br>
  
  <div class="has-text-centered">
    <pagination-controls id='quantity' class="my-pagination" (pageChange)="quantity.meta.page = $event;quantityInventory()" directionLinks="false"
      autoHide="true">
    </pagination-controls>
  </div>

</div>

<br>