<div class="base-bg">
  <h2 class="tituloClaro">EQUIPAMENTOS</h2>
  
  <!-- Linha divisória -->
  <hr style="margin-top: 10px;">
  
  <div class="row">
    <div class="col-sm-12 clear-padding">
      <div class="col-sm-4">
        <p>EQUIPAMENTO</p>
        <ng-select [(ngModel)]="generalEquipamentSearch" 
          (change)="generalInventoryEquipamentChanged()" 
          bindValue="packing" 
          [items]="packings"
          bindLabel="packing" 
          placeholder="Selecione um Equipamento">

          <ng-template ng-label-tmp let-item="item">
            {{item.packing}}
          </ng-template>

          <ng-template ng-option-tmp let-item="item">
            <div>
              <b>Embalagem:</b> {{item.packing}}
            </div>

            <div>
              <small> <b>Fornecedor:</b> {{item.supplier.name}} </small>
            </div>

            <div>
              <small> <b> Projeto:</b> {{item.project.name}} </small>
            </div>
      
          </ng-template>
        </ng-select>
      </div>
    </div>
  </div>

  <br>

  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr class="cabecalho">
          <th>Equipamento</th>
          <th>Serial</th>
          <th>Projeto</th>
          <th>Fornecedor</th>
          <th>Planta Atual</th>
          <th>Local</th>
          <th>Tag</th>
          <th>Bateria</th>
          <th>Temperatura</th>
          <th>Posições</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let packing of general_equipament.data | paginate: {
                                                        id:'general',
                                                        itemsPerPage: 10,
                                                        currentPage: general_equipament.meta.page,
                                                        totalItems: general_equipament.meta.total_docs}">

          <td>{{packing?.code || '-'}}</td>
          <td>{{packing?.serial || '-'}}</td>
          <td>{{packing.project?.name || '-'}}</td>
          <td>{{packing.supplier?.name || '-'}}</td>
          <td [tooltip]="getFormatedData(packing.lastCommunication)" style="cursor: default;">{{packing.actual_plant?.plant ? packing.actual_plant?.plant?.plant_name : (packing.missing ? "Embalagem Ausente"
            : "Embalagem em Viagem")}}</td>
          <td>{{packing.actual_plant?.local === 'Factory' ? 'Fábrica' : (packing.actual_plant?.local === 'Supplier' ? 'Fornecedor':
            (packing.actual_plant?.local === 'Logistic' ? 'Op. Logístico': 'Sem Registro'))}}</td>
          <td>{{packing.tag?.code || '-'}}</td>
          <td>{{packing.battery >= 0 ? (packing.battery | round) : 'Sem Registro'}} %</td>
          <td>{{packing?.temperature || '-'}} ∘</td>
          <td style="text-align: center;">
            <div class="bigger" (click)="openLayer(packing)">
              <div class="det">
              </div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    
    <div class="classVazio" *ngIf="general_equipament.data?.length < 1">
      Ainda não foram cadastradas embalagens no sistema.
    </div>
  </div>

  <br>
  
  <div class="has-text-centered">
    <pagination-controls class="my-pagination" id='general' (pageChange)="general_equipament.meta.page = $event; generalInventoryEquipamentChanged()"
      directionLinks="false" autoHide="true">
    </pagination-controls>
  </div>
</div>

<br>